Full implementation of Bloch 3D expansion

It now fully utilizes the Toeplitz matrix structure
for huge performance improvements.
