

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Electronic structure calculation – a walk-through &mdash; sisl</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom_styles.css?v=cafe85c1" />
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5d6eebe0"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=7800a641"></script>
      <script src="../_static/tabs.js?v=3ee01567"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Berry phase calculation for graphene" href="tutorial_es_2.html" />
    <link rel="prev" title="Tutorials" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            sisl
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Electronic structure calculation – a walk-through</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Creating-the-geometry-to-investigate">Creating the geometry to investigate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Creating-the-electronic-structure">Creating the electronic structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Hamiltonian-eigenstates">Hamiltonian eigenstates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Brillouin-zone-calculations">Brillouin-zone calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Bandstructure">Bandstructure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Calculating-k-averaged-quantities">Calculating <span class="math notranslate nohighlight">\(k\)</span>-averaged quantities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Plotting-eigenstates-on-a-real-space-grid">Plotting eigenstates on a real space grid</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_es_2.html">Berry phase calculation for graphene</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_siesta_2_ahc.html">Anomalous Hall conductivity (AHC) for graphene</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#siesta-transiesta-support">Siesta/TranSiesta support</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#deprecated-tutorials">Deprecated tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/index.html">Visualization (<code class="xref py py-obj docutils literal notranslate"><span class="pre">sisl.viz</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/index.html">Command line scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environment.html">Environment variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toolbox/index.html">Toolboxes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">Contributing to sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extras</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../math.html">Mathematical notation convention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">Related software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sisl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Electronic structure calculation – a walk-through</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/tutorial_es_1.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div align="right">
<a href="https://raw.githubusercontent.com/zerothi/sisl/main/docs/tutorials/tutorial_es_1.ipynb">
    <img alt="ipynb download badge"
        src="https://img.shields.io/badge/download-ipynb-blue.svg"
        style="vertical-align:text-bottom">
</a>
&nbsp;
<a href="https://mybinder.org/v2/gh/zerothi/sisl/main?filepath=docs/tutorials/tutorial_es_1.ipynb">
   <img alt="Binder badge"
        src="https://mybinder.org/badge_logo.svg"
        style="vertical-align:text-bottom">
</a>
</div><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sisl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">si</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sisl.viz</span><span class="w"> </span><span class="kn">import</span> <span class="n">merge_plots</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sisl.viz.processors.math</span><span class="w"> </span><span class="kn">import</span> <span class="n">normalize</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<section id="Electronic-structure-calculation----a-walk-through">
<h1>Electronic structure calculation – a walk-through<a class="headerlink" href="#Electronic-structure-calculation----a-walk-through" title="Link to this heading"></a></h1>
<p>This tutorial will describe a complete walk-through of a large fraction of the <code class="docutils literal notranslate"><span class="pre">sisl</span></code> functionalities. It will show you how to generated default geometries, constructing Hamiltonians, calculating eigenstates and plotting various physical quantities.</p>
<section id="Creating-the-geometry-to-investigate">
<h2>Creating the geometry to investigate<a class="headerlink" href="#Creating-the-geometry-to-investigate" title="Link to this heading"></a></h2>
<p>Our system of interest will be graphene. Instead of creating a graphene flake, or the primary unit-cell of graphene, we will create a vacancy in graphene. We will start by creating a graphene flake</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphene</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">graphene</span><span class="p">()</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This does <em>a lot</em> of things behind the scenes:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">si.geom.graphene</span></code>:</p>
<ul class="simple">
<li><p>create atomic coordinates of pristine graphene with a default bond-length of <span class="math notranslate nohighlight">\(1.42\,\mathrm{Å}\)</span>.</p></li>
<li><p>create pristine graphene unit cell, by default this will create a supercell with a size <code class="docutils literal notranslate"><span class="pre">3x3</span></code>, i.e. a nearest neighbour unit-cell.</p></li>
<li><p>assign a carbon atom with a default of one orbital per atom as the basis</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Geometry.tile</span></code> tiles the geometry <code class="docutils literal notranslate"><span class="pre">(reps,</span> <span class="pre">axis)</span></code> by <code class="docutils literal notranslate"><span class="pre">reps</span></code> times along the unit cell axis <code class="docutils literal notranslate"><span class="pre">axis</span></code></p></li>
</ol>
<p>By printing the object one gets basic information regarding the geometry, such as 1) number and species of atoms, 2) number of orbitals, 3) orbitals associated with each atom and 4) number of supercells.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">graphene</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Geometry{na: 72, no: 72,
 Atoms{species: 1,
  Atom{C, Z: 6, mass(au): 12.01070, maxR: 1.43420,
   Orbital{R: 1.43420, q0: 0.0}
  }: 72,
 },
 maxR: 1.43420,
 Lattice{nsc: [3 3 1],
  origin=[0.0000, 0.0000, 0.0000],
  A=[12.7800, -7.3785, 0.0000],
  B=[12.7800, 7.3785, 0.0000],
  C=[0.0000, 0.0000, 20.0000],
  bc=[Periodic,
      Periodic,
      Unknown]
 }
}
</pre></div></div>
</div>
<p>In this example we have <code class="docutils literal notranslate"><span class="pre">na=72</span></code> atoms, each have one orbital, hence the total number of orbitals is <code class="docutils literal notranslate"><span class="pre">no=72</span></code>. The description of the atomic specie in the geometry tells us we have a carbon atom, with a single orbital with a radius of <span class="math notranslate nohighlight">\(1.4342\,\mathrm{Å}\)</span>. The number of supercells are <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">3,</span> <span class="pre">1]</span></code> which means cells <code class="docutils literal notranslate"><span class="pre">{-1,</span> <span class="pre">0,</span> <span class="pre">1}</span></code> along the first and second lattice are taken into account.</p>
<p>Later we will look into the details of <em>orbitals</em> associated with <em>atoms</em> and how they may be used for wavefunctions etc.</p>
<p>Lets visualize the atomic positions (here adding atomic indices)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graphene</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
<p>Removing an atom can be done with <code class="docutils literal notranslate"><span class="pre">Geometry.remove</span></code>. The routine takes an index, or a list of indices of the atoms to be removed. For instance removing the first atom will result in the following geometry (red atom is the removed atom)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coord</span> <span class="o">=</span> <span class="n">graphene</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">coord</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">atoms_style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">graphene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-2) nodify.node.140561747615360:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747524592:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561784984384:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747607680:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747623472:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561784980880:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747524592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784984384:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747607680:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747623472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784980880:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747524592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747517392:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747616656:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747609120:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561784982704:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561749028464:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747612000:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747520800:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747623376:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747623088:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747613440:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747622896:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747622608:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747608592:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747622272:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747610272:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784982704:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747614208:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747622176:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747621984:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784982704:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619920:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747611232:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747621888:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747524592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747525312:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747868560:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747863328:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561748026064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747617664:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747617472:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747611616:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747524592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747517392:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747616656:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747616896:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747617184:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747613440:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747617616:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561784805696:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747614592:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747618912:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747522096:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784982704:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747613824:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747619872:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561784804256:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784982704:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619920:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747609984:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747609744:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784982704:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784984144:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561785100848:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747524592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784982704:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747805632:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747612672:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747805440:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747613056:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747614592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747622032:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747524592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747525312:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747617664:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747617472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747611616:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747524592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747517392:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747616656:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747616896:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747617184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747613440:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747617616:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784805696:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747614592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747618912:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747524592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747614976:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747524592:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747517392:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747616656:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561784982704:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747525408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747619152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561785098016:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747613440:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747621936:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747621552:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747621792:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747807216:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747815808:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808224:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747857328:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747811248:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747857136:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747856944:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808224:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747857328:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747811248:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747857136:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747856944:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808224:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808176:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747817104:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747810384:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747853488:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747858336:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747812736:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747858144:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747857184:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747856752:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747813888:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747856560:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747856272:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747810864:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747855936:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747811584:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747853488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747814656:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747855840:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747855648:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747853488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747854352:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747811968:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747855552:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808224:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808848:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746041728:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746160784:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746377616:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747818112:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747817824:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747812352:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808224:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808176:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747817104:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747817392:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747817680:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747813888:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747818064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747819168:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747815040:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747819456:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747809184:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747853488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747814272:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747820464:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747819888:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747853488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747854352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747809712:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747810048:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747853488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747854592:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747819024:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808224:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747853488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747860208:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747813120:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747860016:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747813504:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747815040:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747855696:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808224:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808848:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747818112:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747817824:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747812352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808224:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808176:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747817104:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747817392:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747817680:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747813888:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747818064:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747815040:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819456:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808224:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747815424:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808224:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808176:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747817104:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747853488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747819744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747861024:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747813888:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747860064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747855216:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747861168:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747862032:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
<p>For the following it doesn’t matter which atom we remove (since it is peridiodic), however for visualization purposes we will remove an atom in the middle of the unit cell.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">sisl</span></code> it is easy to find atoms close to specific positions. The middle of the atomic coordinates is also the <em>center</em> of atomic coordinates, here <code class="docutils literal notranslate"><span class="pre">Geometry.center</span></code> is useful. The complementary method <code class="docutils literal notranslate"><span class="pre">Geometry.close</span></code> finds all atomic indices close to a given position or atom. By default, <code class="docutils literal notranslate"><span class="pre">Geometry.close</span></code> determines all atoms within a radius equal to the maximum orbital radius. Here we explicitly set the <em>search radius</em> to <span class="math notranslate nohighlight">\(1.5\,\mathrm{Å}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xyz_center</span> <span class="o">=</span> <span class="n">graphene</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="s2">&quot;xyz&quot;</span><span class="p">)</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">graphene</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">xyz_center</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">graphene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="n">graphene</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">axes</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span>
    <span class="n">atoms_style</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>  <span class="c1"># Default style for all atoms</span>
        <span class="p">{</span>
            <span class="s2">&quot;atoms&quot;</span><span class="p">:</span> <span class="n">indices</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span>
            <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">},</span>  <span class="c1"># Styling for indices_close_to_center on top of defaults.</span>
        <span class="p">{</span>
            <span class="s2">&quot;atoms&quot;</span><span class="p">:</span> <span class="n">index</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
            <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;opacity&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">},</span>  <span class="c1"># Styling for center_atom_index on top of defaults.</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-2) nodify.node.140561746601088:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746522048:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746511872:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561748032256:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746512832:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746511248:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746522048:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746511872:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561748032256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746512832:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746511248:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746522048:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746517728:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746606656:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561748030000:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746513072:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746403520:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746367872:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746406016:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746513264:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746405296:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746602288:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746404720:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746400064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561748025344:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746410672:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561748028992:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746513072:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746593984:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746411344:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746594992:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746513072:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746605312:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746377232:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746606752:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746522048:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746521232:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746376608:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746867984:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746410384:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746595856:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746040720:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746372528:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746522048:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746517728:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746606656:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746606704:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746368880:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746602288:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746525936:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746602432:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746595952:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746608000:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746520128:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746513072:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746596528:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746607520:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746605216:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746513072:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746605312:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746510672:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746521136:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746513072:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561748033504:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561748032592:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746522048:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746513072:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746854208:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747861792:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746854016:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746598736:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746595952:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746401552:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746522048:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746521232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746595856:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746040720:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746372528:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746522048:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746517728:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746606656:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746606704:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746368880:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746602288:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746525936:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746602432:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746595952:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746608000:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746522048:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746600128:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746522048:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746517728:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746606656:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746513072:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746518256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746604208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746854976:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746602288:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746404096:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746607280:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746606032:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746164432:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
</section>
<section id="Creating-the-electronic-structure">
<h2>Creating the electronic structure<a class="headerlink" href="#Creating-the-electronic-structure" title="Link to this heading"></a></h2>
<p>To calculate eigenstates, DOS and other physical quantities from the Hamiltonian we need to setup the Hamiltonian. Tthis is done by passing a <code class="docutils literal notranslate"><span class="pre">Geometry</span></code> to a <code class="docutils literal notranslate"><span class="pre">Hamiltonian</span></code> class</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="n">Hamiltonian</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hamiltonian{non-zero: 0, orthogonal: True,
 Spin{unpolarized},
 Geometry{na: 71, no: 71,
  Atoms{species: 1,
   Atom{C, Z: 6, mass(au): 12.01070, maxR: 1.43420,
    Orbital{R: 1.43420, q0: 0.0}
   }: 71,
  },
  maxR: 1.43420,
  Lattice{nsc: [3 3 1],
   origin=[0.0000, 0.0000, 0.0000],
   A=[12.7800, -7.3785, 0.0000],
   B=[12.7800, 7.3785, 0.0000],
   C=[0.0000, 0.0000, 20.0000],
   bc=[Periodic,
       Periodic,
       Unknown]
  }
 }
}
</pre></div></div>
</div>
<div class="line-block">
<div class="line">In addition to the <code class="docutils literal notranslate"><span class="pre">Geometry</span></code> information it informs us that it is an orthogonal basis (<code class="docutils literal notranslate"><span class="pre">sisl</span></code> also allows non-orthogonal basis’). The spin-configuration is an unpolarized configuration (see <code class="docutils literal notranslate"><span class="pre">Spin</span></code> for details).</div>
<div class="line">Currently <code class="docutils literal notranslate"><span class="pre">non-zero</span> <span class="pre">=</span> <span class="pre">0</span></code> specifies that there are <em>no</em> associated Hamiltonian elements stored in this Hamiltonian object.</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Hamiltonian.construct</span></code> lets one specify the Hamiltonian elements in a consistent way. However, note that the <code class="docutils literal notranslate"><span class="pre">Hamiltonian</span></code> objet may be used as though it was a matrix, i.e. <code class="docutils literal notranslate"><span class="pre">Hamiltonian[0,</span> <span class="pre">1]</span> <span class="pre">=</span> <span class="pre">a</span></code> will set the hopping element from the 0th orbital to the 1st orbital to <code class="docutils literal notranslate"><span class="pre">a</span></code>.</div>
<div class="line">We will specify all on-site elements to <span class="math notranslate nohighlight">\(0.\,\mathrm{eV}\)</span>, and all nearest neighbour interactions with <span class="math notranslate nohighlight">\(-2.7\,\mathrm{eV}\)</span>, this is the most common used graphene tight-binding model.</div>
<div class="line">The arguments for the <code class="docutils literal notranslate"><span class="pre">construct</span></code> method is a list of radii and an accompanying list of energies. Here <code class="docutils literal notranslate"><span class="pre">r</span></code> tells <code class="docutils literal notranslate"><span class="pre">sisl</span></code> to find all atoms within a sphere of <span class="math notranslate nohighlight">\(0.1\,\mathrm{Å}\)</span> from each atom and set the corresponding element to <span class="math notranslate nohighlight">\(0\)</span>, secondly all atoms within a spherical radius of <span class="math notranslate nohighlight">\(0.1\,\mathrm{Å}\)</span> to <span class="math notranslate nohighlight">\(1.44\,\mathrm{Å}\)</span> are given the matrix element <span class="math notranslate nohighlight">\(-2.7\,\mathrm{eV}\)</span></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.44</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.7</span><span class="p">)</span>
<span class="n">H</span><span class="o">.</span><span class="n">construct</span><span class="p">([</span><span class="n">r</span><span class="p">,</span> <span class="n">t</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hamiltonian{non-zero: 281, orthogonal: True,
 Spin{unpolarized},
 Geometry{na: 71, no: 71,
  Atoms{species: 1,
   Atom{C, Z: 6, mass(au): 12.01070, maxR: 1.43420,
    Orbital{R: 1.43420, q0: 0.0}
   }: 71,
  },
  maxR: 1.43420,
  Lattice{nsc: [3 3 1],
   origin=[0.0000, 0.0000, 0.0000],
   A=[12.7800, -7.3785, 0.0000],
   B=[12.7800, 7.3785, 0.0000],
   C=[0.0000, 0.0000, 20.0000],
   bc=[Periodic,
       Periodic,
       Unknown]
  }
 }
}
</pre></div></div>
</div>
<p>Now the Hamiltonian has <span class="math notranslate nohighlight">\(281=71\cdot4-3\)</span> non-zero elements (as expected).</p>
</section>
<section id="Hamiltonian-eigenstates">
<h2>Hamiltonian eigenstates<a class="headerlink" href="#Hamiltonian-eigenstates" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line">At this point we have 1) a complete geometry describing a supercell structure with nearest cell neighbour interactions, 2) a Hamiltonian with nearest neighbour interactions describing the electronic structure.</div>
<div class="line">This completes what is needed to calculate a great deal of physical quantities, e.g. eigenstates, density of states, projected density of states and bandstructures.</div>
</div>
<p>To begin with we calculate the <span class="math notranslate nohighlight">\(\Gamma\)</span>-point eigenstates and plot a subset of the eigenstates’ norm on the geometry.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">es</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenstate</span><span class="p">()</span>
<span class="c1"># Reduce the contained eigenstates to only 3 states around the Fermi-level</span>
<span class="n">es_fermi</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">plots</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">system</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">atoms_style</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">c</span><span class="p">}])</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">es_fermi</span><span class="o">.</span><span class="n">norm2</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;orbital&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">))</span>
<span class="p">]</span>

<span class="n">merge_plots</span><span class="p">(</span><span class="o">*</span><span class="n">plots</span><span class="p">,</span> <span class="n">composite_method</span><span class="o">=</span><span class="s2">&quot;subplots&quot;</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-2) nodify.node.140561746997712:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745003584:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746807744:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746817680:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745004544:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745003920:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745003584:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746807744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746817680:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745004544:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745003920:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745003584:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745004448:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746987680:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746814656:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745095200:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745098176:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561784813616:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745094720:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746518208:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745090160:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746514512:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745094336:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745087184:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746817728:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745094096:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746814896:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745095200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746407600:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745092128:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745089248:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745095200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746861744:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746817200:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745092656:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745003584:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745009632:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746865440:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745355040:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745525648:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745091696:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745088048:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746814176:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745003584:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745004448:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746987680:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746860976:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746991472:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746514512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745018752:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746860352:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746396272:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746987872:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745014672:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745095200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746599168:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745096592:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746989696:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745095200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746861744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746809904:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746815424:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745095200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991616:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745007184:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745003584:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745095200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745096736:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746522432:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745094624:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746515280:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746396272:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745093904:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745003584:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745009632:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745091696:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745088048:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746814176:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745003584:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745004448:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746987680:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746860976:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746514512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745018752:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746860352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746396272:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746987872:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745003584:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746994832:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745003584:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745004448:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746987680:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745095200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561747808560:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746991232:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746154640:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746514512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746510480:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746857184:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746859392:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745017552:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745351200:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746866304:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745359936:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745100768:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745359744:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745359552:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746866304:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745359936:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745100768:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745359744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745359552:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746866304:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746870000:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745352496:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745097840:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745356096:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745360944:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745348032:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745360752:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745359792:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745359360:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745349280:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745359168:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745358880:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745100432:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745358544:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745346976:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745350048:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745358448:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745358256:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356960:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745347312:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745358160:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746866304:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745089584:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746990800:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745275328:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745525648:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745353552:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745353360:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745347840:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746866304:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746870000:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745352496:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745352784:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745353072:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745349280:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745353504:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745354608:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745350432:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745354896:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745099328:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745349664:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745355904:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745355328:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356960:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745099520:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745098128:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745357200:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745356048:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746866304:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745362816:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745348512:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745362624:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745348896:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745350432:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745358304:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746866304:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745089584:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745353552:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745353360:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745347840:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746866304:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746870000:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745352496:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745352784:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745353072:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745349280:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745353504:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745354608:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745350432:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745354896:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746866304:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745350816:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746866304:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746870000:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745352496:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746865200:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745355184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745412848:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745349280:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745362672:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745357824:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745358064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745413856:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745421488:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745356816:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745512208:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745416880:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745512016:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745511824:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745356816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745512208:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745416880:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745512016:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745511824:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745414000:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745422784:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745416160:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745426384:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745513216:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745418416:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745513024:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745512064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745511632:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745419568:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745511440:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745511152:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745416400:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745510816:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745417312:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745426384:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745420336:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745510720:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745510528:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745426384:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745427248:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745417600:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745428448:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745356816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745414528:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746857088:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746867408:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746863568:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745423840:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745423648:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745418080:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745356816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745414000:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745422784:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745423072:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745423360:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745419568:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745423792:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745424896:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745420720:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745425184:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745414960:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745426384:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745419952:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745426192:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745425616:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745426384:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745427248:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745415248:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745415728:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745426384:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745427488:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745426336:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745356816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745426384:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745515088:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745418800:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745514896:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745419184:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745420720:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745428304:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745356816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745414528:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745423840:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745423648:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745418080:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745414000:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745422784:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745423072:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745423360:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745419568:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745423792:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745424896:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745420720:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425184:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745356816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745421104:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745356816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745414000:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745422784:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745426384:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745357968:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745425472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745515904:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745419568:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745514944:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745428112:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745428352:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745516912:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Hamiltonian.eigenstate</span></code> (with an optional <span class="math notranslate nohighlight">\(k\)</span>-point argument) routine returns an <code class="docutils literal notranslate"><span class="pre">EigenstateElectron</span></code> object which holds the eigenvalues and eigenvectors for a given <span class="math notranslate nohighlight">\(k\)</span>-point. This object can perform several advanced calculations:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EigenstateElectron.DOS</span></code>: calculate the DOS at a given set of energy values (in eV), additionally one can pass a distribution function if the default Gaussian with <span class="math notranslate nohighlight">\(\sigma=0.1\,\mathrm{eV}\)</span> is not wanted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EigenstateElectron.PDOS</span></code>: calculate the projected DOS at a given set of energy values (in eV), additionally one can pass a distribution function if the default Gaussian with <span class="math notranslate nohighlight">\(\sigma=0.1\,\mathrm{eV}\)</span> is not wanted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EigenstateElectron.wavefunction</span></code>: add <em>all</em> contained eigenstates to a passed real-space grid.</p></li>
</ul>
<p>Lets first try and calculate the DOS for a given set of energies in the range <span class="math notranslate nohighlight">\(-4\,\mathrm{eV}\)</span> : <span class="math notranslate nohighlight">\(\mathrm{4}\,\mathrm{eV}\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">es</span><span class="o">.</span><span class="n">DOS</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$E - E_F$ [eV]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;DOS at $\Gamma$ [1/eV]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_tutorial_es_1_19_0.png" src="../_images/tutorials_tutorial_es_1_19_0.png" />
</div>
</div>
<p>The projected DOS (in this case) can aptly be plotted on individual atoms as will be seen in the following. We will integrate the PDOS in the range <span class="math notranslate nohighlight">\(-1\,\mathrm{eV}\)</span> to <span class="math notranslate nohighlight">\(-0.5\,\mathrm{eV}\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">dE</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">PDOS</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">PDOS</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">dE</span>  <span class="c1"># perform integration</span>
<span class="n">system</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">atoms_style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">normalize</span><span class="p">(</span><span class="n">PDOS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)})</span>
<span class="c1"># plt.scatter(system.xyz[:, 0], system.xyz[:, 1], 500 * PDOS);</span>
<span class="c1"># plt.scatter(xyz_remove[0], xyz_remove[1], c=&#39;k&#39;, marker=&#39;*&#39;); # mark the removed atom</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-2) nodify.node.140561674680176:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745012128:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745270144:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676252656:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746812976:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675783824:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745012128:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745270144:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676252656:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746812976:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675783824:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745012128:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676390032:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746370176:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675787712:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674798480:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674802272:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674676480:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674801648:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675782000:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676242240:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674678256:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676062064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676205376:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675790448:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676191408:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676248384:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674798480:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674679024:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674800400:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675783584:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674798480:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674799008:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676254864:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674800112:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745012128:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676389984:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675790736:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674811632:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746377616:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676254192:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746597776:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676244496:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745012128:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676390032:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746370176:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674681568:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674681472:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674678256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674681856:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675784544:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674679408:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676254096:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676398096:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674798480:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674678640:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676243824:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676243584:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674798480:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674799008:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675789104:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675781184:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674798480:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675787808:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676191792:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745012128:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674798480:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674803904:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674677488:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674803712:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674677872:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674679408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674800256:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745012128:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676389984:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676254192:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746597776:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676244496:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745012128:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676390032:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746370176:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674681568:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674681472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674678256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674681856:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675784544:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674679408:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676254096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561745012128:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674679792:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561745012128:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676390032:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561746370176:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561674798480:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676198512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676197600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676388064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674678256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675780320:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675787424:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675787088:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676243680:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
<p>This highlights a somewhat <em>localized</em> state around the missing atom.</p>
</section>
<section id="Brillouin-zone-calculations">
<h2>Brillouin-zone calculations<a class="headerlink" href="#Brillouin-zone-calculations" title="Link to this heading"></a></h2>
<p>The above DOS and PDOS analysis are useful for investigating a single <span class="math notranslate nohighlight">\(k\)</span>-point at a time. However, they are incomplete in the sense of the full Brillouin zone. To leverage this <code class="docutils literal notranslate"><span class="pre">sisl</span></code>, implements several classes to handle Brillouin-zones.</p>
<p>In the following we will show how to perform band structure calculations as well as performing <span class="math notranslate nohighlight">\(k\)</span>-averaged quantities in the Brillouin zone.</p>
<section id="Bandstructure">
<h3>Bandstructure<a class="headerlink" href="#Bandstructure" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line">An easy and useful analysis is the <em>band structure</em>. In <code class="docutils literal notranslate"><span class="pre">sisl</span></code> calculating the band-structure is as easy as anything else.</div>
<div class="line">Begin by defining the path in the Brillouin zone.</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">band</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="n">BandStructure</span><span class="p">(</span>
    <span class="n">H</span><span class="p">,</span>
    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
    <span class="mi">200</span><span class="p">,</span>
    <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;Gamma&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Gamma&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note that the integer <code class="docutils literal notranslate"><span class="pre">400</span></code> determines the total number of <span class="math notranslate nohighlight">\(k\)</span>-points on the full band. One <em>can</em> define an explicit number between the different points, however we highly encourage only specifying <em>one</em> integer as the divisions will be determined based on the length in the reciprocal space between the points and thus the physical distance in the Brillouin zone will be correct.</p>
<p>A word of note on the <code class="docutils literal notranslate"><span class="pre">BrillouinZone</span></code> objects.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">BrillouinZone</span></code> objects are <em>extremely</em> handy because they allow to directly call <em>any</em> routine inherent to the passed object. If calling routine <code class="docutils literal notranslate"><span class="pre">band.a()</span></code> it is equivalent to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for k in band: yield band.parent.a(k=k)
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">BrillouinZone</span></code> defaults to use <code class="docutils literal notranslate"><span class="pre">BrillouinZone.apply.iter</span></code>.</p>
<p>However, for large systems this may result in memory problems in which case it may be necessary to return an iterator. To circumvent this we can tell the Brillouin zone object to (always) return a list instead:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>b_list = band.apply.list
as_list = b_list.a()
</pre></div>
</div>
<p>Another option is to return <span class="math notranslate nohighlight">\(k\)</span>-point averaged quantities which is roughly equivalent to (internally it is done with minimal memory usage):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>band.apply.average.a() == sum([band.parent.a(k=k) * band.weight[i] for i, k in enumerate(band)])
</pre></div>
</div>
<p>Now we can calculate the band structure. A band-structure requires <em>all</em> eigenvalues and thus we ask the <code class="docutils literal notranslate"><span class="pre">BrillouinZone</span></code> object to return all values using <code class="docutils literal notranslate"><span class="pre">apply.array</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">band</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Erange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-2) nodify.node.140561675300848:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675217488:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675046976:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675222432:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675222144:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676070512:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676252128:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675131152:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676249824:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675137392:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675292400:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675301616:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676388640:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675293744:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675132352:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676388640:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675294272:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675222480:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675132016:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675294992:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676388640:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675293312:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675292400:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675302096:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675217488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675046976:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676190880:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675217488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675046976:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675222432:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675222144:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676070512:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676252128:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675131152:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675303248:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674983360:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675294560:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675289088:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675300656:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675295808:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676388640:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675213696:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676191936:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675295904:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561746369216:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
</section>
<section id="Calculating-k-averaged-quantities">
<h3>Calculating <span class="math notranslate nohighlight">\(k\)</span>-averaged quantities<a class="headerlink" href="#Calculating-k-averaged-quantities" title="Link to this heading"></a></h3>
<p>Now we are in a position to calculate a subset of quantities from the Hamiltonian. Before proceeding we will note that the Hamiltonian also implements the <code class="docutils literal notranslate"><span class="pre">DOS</span></code> and <code class="docutils literal notranslate"><span class="pre">PDOS</span></code> methods (equivalent to <code class="docutils literal notranslate"><span class="pre">Hamiltonian.eigenvalue().DOS()</span></code>), hence to calculate these as <span class="math notranslate nohighlight">\(k\)</span>-averaged quantities we can create a Brillouin zone object with proper weights, say a Monkhorst-Pack grid, and calculate the averaged quantities.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bz</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="n">MonkhorstPack</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">bz_average</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">bz</span><span class="o">.</span><span class="n">apply</span><span class="o">.</span><span class="n">average</span>
<span class="p">);</span>  <span class="c1"># specify the Brillouin zone to perform an average of subsequent method calls</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">bz_average</span><span class="o">.</span><span class="n">eigenstate</span><span class="p">(</span><span class="n">wrap</span><span class="o">=</span><span class="k">lambda</span> <span class="n">es</span><span class="p">:</span> <span class="n">es</span><span class="o">.</span><span class="n">DOS</span><span class="p">(</span><span class="n">E</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$E - E_F$ [eV]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;DOS [1/eV]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_tutorial_es_1_28_0.png" src="../_images/tutorials_tutorial_es_1_28_0.png" />
</div>
</div>
<p>We can also plot the projected DOS integrated around the Fermi level on the atoms</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">dE</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">PDOS</span> <span class="o">=</span> <span class="n">bz_average</span><span class="o">.</span><span class="n">eigenstate</span><span class="p">(</span><span class="n">wrap</span><span class="o">=</span><span class="k">lambda</span> <span class="n">es</span><span class="p">:</span> <span class="n">es</span><span class="o">.</span><span class="n">PDOS</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span> <span class="o">*</span> <span class="n">dE</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="n">atoms_style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">normalize</span><span class="p">(</span><span class="n">PDOS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)})</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-2) nodify.node.140562367532832:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367028096:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367330400:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367422992:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366908752:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675536096:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367028096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367330400:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367422992:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366908752:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675536096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367028096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366907456:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367420400:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367421024:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367143600:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367142544:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675534752:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367418816:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367144128:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367140480:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367529424:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366914608:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675539168:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367428896:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366910480:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367425200:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367143600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367530192:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367534224:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367531104:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367143600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420976:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367423760:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367531824:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367028096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366913840:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561786681632:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675045584:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675404736:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367137744:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676247088:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675548288:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367028096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366907456:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420400:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367421360:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676245360:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367529424:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675292928:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366913120:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367532064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366914080:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367324928:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367143600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367529232:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367140000:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675541136:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367143600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420976:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367426592:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367419392:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367143600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675786752:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675222096:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367028096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367143600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367537056:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675540320:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367536864:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675537920:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367532064:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675045680:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367028096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366913840:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367137744:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676247088:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675548288:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367028096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366907456:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420400:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367421360:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561676245360:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367529424:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140561675292928:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366913120:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367532064:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366914080:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367028096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367532448:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367028096:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366907456:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420400:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367143600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367136352:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366919168:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367141200:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367529424:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367416128:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366912400:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367329872:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367419104:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
</section>
</section>
<section id="Plotting-eigenstates-on-a-real-space-grid">
<h2>Plotting eigenstates on a real space grid<a class="headerlink" href="#Plotting-eigenstates-on-a-real-space-grid" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sisl</span></code> also implements methods to plot orbitals on grids. Often it may also be advantageous to plot simple orbitals to check their appearence. <code class="docutils literal notranslate"><span class="pre">sisl</span></code> implements a simple variation of spherical atomic orbitals. Other orbitals may easily be added, if so desired.</p>
<p>Since we require orbitals to be zero at some maximum cut-off <span class="math notranslate nohighlight">\(r_\mathrm{max}\)</span> a radial function is used to cutoff the spherical harmonics. In this case we will simply use an exponential function with a cutoff radius of <span class="math notranslate nohighlight">\(1.6\,\mathrm{Å}\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mi">700</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Normalization: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="n">orb</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="n">SphericalOrbital</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">f</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Normalization: 1.0053998295349618
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_tutorial_es_1_33_1.png" src="../_images/tutorials_tutorial_es_1_33_1.png" />
</div>
</div>
<p>To calculate the orbital on a 3D grid, the <code class="docutils literal notranslate"><span class="pre">Orbital.toGrid</span></code> function is available. Here we create an orbital with azimuthal quantum number <span class="math notranslate nohighlight">\(l=1\)</span> and by default it has angular moment <span class="math notranslate nohighlight">\(0\)</span>, i.e. the <span class="math notranslate nohighlight">\(2p_z\)</span> orbital. To create a <span class="math notranslate nohighlight">\(2p_x\)</span> or <span class="math notranslate nohighlight">\(2p_y\)</span> orbital requires the use of an <code class="docutils literal notranslate"><span class="pre">AtomicOrbital</span></code> to denote the <span class="math notranslate nohighlight">\(m\)</span> quantum number. Below we create the grid that describes the <span class="math notranslate nohighlight">\(p_z\)</span> orbital and plot the <span class="math notranslate nohighlight">\(yz\)</span> plane at <span class="math notranslate nohighlight">\(x=0\)</span> (with respect to the position
of the orbital).</p>
<p>Note that the real-space orbital will <em>not</em> be normalized and thus <span class="math notranslate nohighlight">\(\int|\psi(\mathbf r)|^2\neq 1\)</span>, as it should. The following analysis is thus a qualitative analysis.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">orb</span><span class="o">.</span><span class="n">toGrid</span><span class="p">()</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="o">-</span><span class="n">grid</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_tutorial_es_1_36_0.png" src="../_images/tutorials_tutorial_es_1_36_0.png" />
</div>
</div>
<p>This <em>simple orbital model</em> may be used to plot the real-space tight-binding eigenstates. Our first task will be to tell the geometry that the orbital associated with the Carbon atoms is the <span class="math notranslate nohighlight">\(2p_z\)</span> orbital as noted above. First we create the Carbon atom, then we replace the atom in the system geometry.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="n">Atom</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">orb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">C</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Atoms{species: 1,
 Atom{C, Z: 6, mass(au): 12.01070, maxR: 1.43420,
  Orbital{R: 1.43420, q0: 0.0}
 }: 71,
}
Atoms{species: 1,
 Atom{C, Z: 6, mass(au): 12.01070, maxR: 1.55180,
  SphericalOrbital{l: 1, R: 1.5517999999999998, q0: 0.0}
 }: 71,
}
</pre></div></div>
</div>
<p>Note the difference between the two <code class="docutils literal notranslate"><span class="pre">print(system)</span></code> statements, before the replacement, an intrinsic <code class="docutils literal notranslate"><span class="pre">Orbital</span></code> object describes the orbital, in effect no knowledge other than the radius. After replacement, the spherical orbital with azimuthal angular moment <span class="math notranslate nohighlight">\(l=1\)</span> is replaced. Now we can plot the real-space grid for an eigenstate.</p>
<p>Lets plot one of the <span class="math notranslate nohighlight">\(\Gamma\)</span>-point eigenstates close to the Fermi-level.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">es</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigenstate</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">si</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="mf">0.075</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">H</span><span class="o">.</span><span class="n">lattice</span><span class="p">)</span>
<span class="n">es</span><span class="o">.</span><span class="n">wavefunction</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-2) nodify.node.140562367327376:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367533600:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367728336:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366139328:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366038816:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366144368:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367421312:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367418864:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366046016:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367727472:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367738656:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561676190736:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675541232:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561675542768:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367324688:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562365893568:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367145376:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367533600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367728336:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366139328:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366038816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366144368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367421312:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367418864:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366046016:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367727472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367421312:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367418864:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367731648:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367530576:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366047696:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562365891840:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367421312:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367418864:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367533600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367728336:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366139328:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366038816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366144368:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367421312:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367418864:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366046016:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367727472:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367421312:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367418864:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367731648:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366038816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367424144:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366038960:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366051920:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562365904848:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562365892656:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366042800:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366138128:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367533600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562365894960:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367421312:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367418864:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562365895872:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367737648:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367330064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367533600:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366039536:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367421312:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367418864:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366038816:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367317008:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367734864:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367538448:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366045008:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140561674990272:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
<div class="line-block">
<div class="line">Note that the plot function will automatically orthogonalize by extending the grid. To see the grid plot in the lattice vector representation one can do the following. However, this will introduce a skewedness in the plot that should be quite visible.</div>
<div class="line">The above plot shows <span class="math notranslate nohighlight">\(\psi(x, y, 0.1\,\mathrm{Å})\)</span> for all <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. Note the similarity with the norm of the Hamiltonian eigenstates. However, in this plot we see that the wavefunction changes sign on alternating atoms.</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="s2">&quot;ab&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO    Task(Task-2) nodify.node.140562366459216:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367730112:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367318256:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366579920:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366331360:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367420064:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367733280:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367420544:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366324976:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366579488:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367536528:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366449664:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366454464:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366448416:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366461040:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366322432:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366317344:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367730112:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367318256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366579920:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366331360:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420064:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367733280:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420544:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366324976:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366579488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367733280:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420544:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366579440:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367415168:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366320224:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366151904:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367733280:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420544:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367730112:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367318256:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366579920:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366331360:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420064:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367733280:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420544:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366324976:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366579488:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367733280:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420544:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366579440:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366331360:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366578816:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366043376:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366039296:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366454800:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366448704:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366047120:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366463968:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367730112:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366448128:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367733280:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420544:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366457536:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366463824:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366458448:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367730112:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366453456:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562367733280:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562367420544:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366331360:node.py:get()- No need to evaluate
INFO    Task(Task-2) nodify.node.140562366452784:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366453552:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366324736:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366463872:node.py:get()- Evaluated because inputs changed.
INFO    Task(Task-2) nodify.node.140562366331600:node.py:get()- Evaluated because inputs changed.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="admonition warning">
<p>Data type cannot be displayed: application/vnd.plotly.v1+json</p>
</div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial_es_2.html" class="btn btn-neutral float-right" title="Berry phase calculation for graphene" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015-2025, sisl developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>